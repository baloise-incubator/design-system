import { Meta } from '@storybook/addon-docs'

<Meta
  title="Development/Implementation/Modal"
  parameters={{
    previewTabs: {
      canvas: { hidden: true },
    },
  }}
/>

<bal-doc-banner id="overview" subtitle="Implementation">Modal</bal-doc-banner>

<bal-doc-tabs>
  <a href="#overview">Overview</a>
  {/* <a href="#usage-with-basic-html5">HTML</a> */}
  <a href="#usage-with-angular">Angular</a>
  <a href="#usage-with-vue">Vue</a>
  {/* <a href="#usage-with-react">React</a> */}
</bal-doc-tabs>

<bal-doc-lead>
  Some of the Baloise Design System components offering methods to setFocus or returning native HTML elements.
</bal-doc-lead>

<!-- ## Usage with basic HTML5 -->

## Usage with Angular

For the angular framework we provide a `ModalService` to create more easily and dynamic.

Create a html and a typescript file for your modal component like this.

**modal.component.html**

```html
<bal-modal-header>Modal Title</bal-modal-header>
<bal-modal-body>
  <p>{{ firstName }}</p>
  <p>{{ lastName }}</p>
  <p>
    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna
    aliqua.
  </p>
  <bal-button-group position="right" class="mt-medium">
    <bal-button color="link" (click)="closeModal()">Cancel</bal-button>
    <bal-button color="primary" (click)="closeModal()">Okay</bal-button>
  </bal-button-group>
</bal-modal-body>
```

With the help of the `BalModalService` we are able to close the modal.

**modal.component.ts**

```typescript
import { Component, Input } from '@angular/core'
import { BalModalService } from '@baloise/design-system-components-angular'

@Component({
  selector: 'app-modal',
  templateUrl: './modal.component.html',
})
export class ModalComponent {
  // Data passed in by componentProps
  @Input() firstName!: string
  @Input() lastName!: string

  constructor(private modalService: BalModalService) {}

  closeModal() {
    // using the injected ModalController this page
    // can "dismiss" itself and optionally pass back data
    this.modalService.dismiss({
      dismissed: true,
    })
  }
}
```

From the main component we can easily create a modal with the `BalModalService`.

**app.component.ts**

```typescript
import { Component } from '@angular/core'
import { BalModalService } from '@baloise/design-system-components-angular'
import { ModalComponent } from './modal.component'

@Component({
  selector: 'app-modal-page',
  templateUrl: './modal-page.component.html',
})
export class ModalPageComponent {
  modal!: HTMLBalModalElement

  constructor(private modalService: BalModalService) {}

  async openModal() {
    this.modal = await this.modalService.create({
      component: ModalComponent,
      componentProps: {
        firstName: 'Peter',
        lastName: 'Parker',
      },
    })
    await this.modal.present()

    // Collect the data from the modal through the dismiss event
    const { data } = await this.modal.onWillDismiss()

    // React onDidDismiss
    await this.modal.onDidDismiss()
    someFunctionToDoOnDidDismissAction()
  }

  closeModal() {
    this.modal.dismiss()
  }
}
```

## Usage with Vue

Define the component for the content of the modal in a separate .vue file.

With the help of the `balModalController.dismiss()` we are able to close the modal.

**MyModal.vue**

```html
<script setup lang="ts">
  import { defineProps } from 'vue'
  import { balModalController, BalModalHeader, BalModalBody, BalButton } from '@baloise/design-system-components-vue'

  defineProps({
    firstName: { type: String },
    lastName: { type: String },
  })

  const closeModal = () => balModalController.dismiss()
</script>

<template>
  <BalModalHeader>Modal Title</BalModalHeader>
  <BalModalBody>
    <p>{{ firstName }} {{ lastName }}</p>
    <BalButtonGroup position="right" class="mt-medium">
      <BalButton color="link" @click="closeModal()">Cancel</BalButton>
      <BalButton color="primary" @click="closeModal()">Okay</BalButton>
    </BalButtonGroup>
  </BalModalBody>
</template>
```

From the main component we can easily create a modal with the `balModalController`.

**App.vue**

```html
<script setup lang="ts">
  import { balModalController, BalButton } from '@baloise/design-system-components-vue'
  import MyModal from '@/components/MyModal.vue'

  const openModal = async () => {
    const modal = await balModalController.create({
      component: MyModal,
      componentProps: {
        firstName: 'Peter',
        lastName: 'Parker',
      },
    })
    return modal.present()
  }
</script>

<template>
  <BalButton @click="openModal()">Open Modal</BalButton>
</template>
```

<!-- ## Usage with React -->

<bal-doc-github link="/stories/development/implementation/06-modal.stories.mdx"></bal-doc-github>
